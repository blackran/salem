{"ast":null,"code":"var _jsxFileName = \"/home/files/hybrid_pojects/SALEM/frontend/src/Components/Serveur/AnnexGReglements.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport { Button, TextField } from '@material-ui/core';\nimport { urlHeader } from '../../Actions/config';\nimport { Link } from '@material-ui/core';\n\nclass AnnexGReglements extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      argentAjouter: ''\n    };\n  }\n\n  UpdateArgentRecu(e, reste) {\n    var stock = [];\n    console.log('argentAjouter:' + parseInt(this.state.argentAjouter) + ' reste:' + parseInt(reste));\n\n    if (parseInt(this.state.argentAjouter) < parseInt(reste)) {\n      stock = [{\n        numReglement: e.numReglement,\n        montantReglement: parseInt(this.state.argentAjouter) + parseInt(e.montantReglement),\n        etatReglement: e.etatReglement,\n        anneeReglement: e.anneeReglement\n      }];\n    } else {\n      stock = [{\n        numReglement: e.numReglement,\n        montantReglement: parseInt(reste) + parseInt(e.montantReglement),\n        etatReglement: '1',\n        anneeReglement: e.anneeReglement\n      }];\n\n      if (parseInt(this.state.argentAjouter) - parseInt(reste) > 0) {\n        alert('donner ' + (parseInt(this.state.argentAjouter) - parseInt(reste)) + 'Ar au clients');\n      }\n    }\n\n    this.props.updateReglements(stock);\n    this.setState({\n      argentAjouter: ''\n    });\n  }\n\n  OnChangeUpdateArgentRecu(reste, e) {\n    // if((parseInt(reste)-parseInt(e.target.value))>=0){\n    this.setState({\n      argentAjouter: e.target.value\n    }); // }\n  }\n\n  MontantReservationReglement(NumReglement) {\n    var montantReglement = 0;\n    const stock = this.props.reserver.dataReserver.filter(e => {\n      return e.numReglement === NumReglement;\n    });\n\n    if (stock !== null && stock.length !== 0) {\n      const nameChambres = this.props.concerner.dataConcerner.filter(e => {\n        return e.numReservation === stock[0].numReservation;\n      });\n\n      if (nameChambres !== null && nameChambres.length !== 0) {\n        var prix = this.props.chambres.dataChambres.filter(e => {\n          return e.nomChambre === nameChambres[0].nomChambre;\n        });\n\n        if (prix !== null && prix.length !== 0) {\n          const date2 = new Date(stock[0].dateFinReservation);\n          const date1 = new Date(stock[0].dateDebutReservation);\n          montantReglement = parseInt(prix[0].prixChambre) * Math.round((date2 - date1) / (1000 * 3600 * 24));\n        } //\n\n      }\n    }\n\n    return montantReglement;\n  }\n\n  reservationReglement(numReglement) {\n    const stock = this.props.reserver.dataReserver.filter(e => {\n      return e.numReglement === numReglement;\n    });\n    return stock;\n  }\n\n  componentDidMount() {\n    if (this.props.reserver.dataReserver.length === 0) {\n      axios.get(urlHeader + \"Reservation/get\").then(res => res.data).then(state => this.props.fetchReserver(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n\n    if (this.props.concerner.dataConcerner.length === 0) {\n      axios.get(urlHeader + \"Concerner/get\").then(res => res.data).then(state => this.props.fetchConcerner(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n\n    if (this.props.chambres.dataChambres.length === 0) {\n      axios.get(urlHeader + \"Chambres/get\").then(res => res.data).then(state => this.props.fetchchambres(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n  }\n\n  render() {\n    const reste = this.MontantReservationReglement(this.props.data.numReglement) - this.props.data.nontantReglement;\n    return React.createElement(\"div\", {\n      style: {\n        margin: 10,\n        display: 'flex',\n        justifyContent: 'space-between'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"Num: \", this.props.data.numReglement, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }), \"Montant Recu: \", this.props.data.montantReglement, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }), \"Montant Rest: \", reste, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }), \"Etat: \", this.props.data.etatReglement, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }), \"Annee: \", this.props.data.anneeReglement, this.reservationReglement(this.props.data.numReglement).map(e => {\n      return React.createElement(\"div\", {\n        key: e.numReservation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, \"Reservation: \", e.numReservation, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }), \"Client: \", e.numClient);\n    })), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, reste !== 0 ? React.createElement(\"div\", {\n      style: {\n        marginRight: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(TextField, {\n      type: \"number\",\n      onChange: this.OnChangeUpdateArgentRecu.bind(this, reste),\n      variant: \"outlined\",\n      value: this.state.argentAjouter,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }), React.createElement(Button, {\n      size: \"small\",\n      variant: \"contained\",\n      style: {\n        marginTop: 5,\n        float: 'right'\n      },\n      onClick: () => this.UpdateArgentRecu(this.props.data, reste),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \"ajouter\")) : React.createElement(Link, {\n      to: \"/Facture\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(Button, {\n      size: \"small\",\n      variant: \"contained\",\n      style: {\n        marginTop: 5,\n        float: 'right'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, \"facturer \"))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    reserver: state.reserver,\n    chambres: state.chambres,\n    concerner: state.concerner\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    fetchchambres: data => {\n      dispatch({\n        type: \"FETCH_CHAMBRES\",\n        data: data\n      });\n    },\n    fetchReglements: data => {\n      dispatch({\n        type: \"FETCH_REGLEMENTS\",\n        data: data\n      });\n    },\n    fetchReserver: data => {\n      dispatch({\n        type: \"FETCH_RESERVER\",\n        data: data\n      });\n    },\n    fetchConcerner: data => {\n      dispatch({\n        type: \"FETCH_CONCERNER\",\n        data: data\n      });\n    },\n    updateReglements: data => {\n      dispatch({\n        type: \"UPDATE_REGLEMENTS\",\n        data: data\n      });\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnnexGReglements);","map":{"version":3,"sources":["/home/files/hybrid_pojects/SALEM/frontend/src/Components/Serveur/AnnexGReglements.js"],"names":["React","Component","connect","axios","Button","TextField","urlHeader","Link","AnnexGReglements","constructor","props","state","argentAjouter","UpdateArgentRecu","e","reste","stock","console","log","parseInt","numReglement","montantReglement","etatReglement","anneeReglement","alert","updateReglements","setState","OnChangeUpdateArgentRecu","target","value","MontantReservationReglement","NumReglement","reserver","dataReserver","filter","length","nameChambres","concerner","dataConcerner","numReservation","prix","chambres","dataChambres","nomChambre","date2","Date","dateFinReservation","date1","dateDebutReservation","prixChambre","Math","round","reservationReglement","componentDidMount","get","then","res","data","fetchReserver","catch","err","fetchConcerner","fetchchambres","render","nontantReglement","margin","display","justifyContent","map","numClient","marginRight","bind","marginTop","float","mapStateToProps","mapDispatchToProps","dispatch","type","fetchReglements"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {connect} from 'react-redux';\nimport axios from 'axios';\nimport {Button, TextField} from '@material-ui/core';\nimport {urlHeader} from '../../Actions/config';\nimport {\n  Link\n} from '@material-ui/core';\n\nclass AnnexGReglements extends Component {\n  constructor(props){\n    super(props);\n    this.state={\n      argentAjouter: ''\n    }\n  }\n\n  UpdateArgentRecu(e, reste){\n    var stock = [];\n    console.log('argentAjouter:'+parseInt(this.state.argentAjouter) +' reste:'+ parseInt(reste))\n    if(parseInt(this.state.argentAjouter) < parseInt(reste)){\n      stock = [\n        {\n          numReglement:e.numReglement,\n          montantReglement: parseInt(this.state.argentAjouter) + parseInt(e.montantReglement),\n          etatReglement: e.etatReglement,\n          anneeReglement: e.anneeReglement\n        }\n      ]\n\n    }else{\n      stock = [\n        {\n          numReglement:e.numReglement,\n          montantReglement: parseInt(reste) + parseInt(e.montantReglement),\n          etatReglement: '1',\n          anneeReglement: e.anneeReglement\n        }\n      ]\n      if((parseInt(this.state.argentAjouter) - parseInt(reste))>0){\n        alert('donner '+(parseInt(this.state.argentAjouter) - parseInt(reste))+'Ar au clients')\n      }\n    }\n    this.props.updateReglements(stock);\n    this.setState({\n      argentAjouter: ''\n    })\n  }\n\n  OnChangeUpdateArgentRecu(reste, e){\n    // if((parseInt(reste)-parseInt(e.target.value))>=0){\n      this.setState({\n        argentAjouter: e.target.value\n      })\n    // }\n  }\n\n  MontantReservationReglement(NumReglement){\n    var montantReglement = 0;\n    const stock = this.props.reserver.dataReserver.filter(e=>{\n      return e.numReglement === NumReglement;\n    });\n    if(stock !== null && stock.length !== 0){\n      const nameChambres = this.props.concerner.dataConcerner.filter(e=>{\n        return e.numReservation === stock[0].numReservation\n      });\n\n      if(nameChambres !== null && nameChambres.length !== 0){\n        var prix = this.props.chambres.dataChambres.filter(e=>{\n          return e.nomChambre === nameChambres[0].nomChambre;\n        });\n        if(prix!==null && prix.length !== 0){\n          const date2 = new Date(stock[0].dateFinReservation);\n          const date1 = new Date(stock[0].dateDebutReservation);\n          montantReglement = parseInt(prix[0].prixChambre) * (Math.round((date2 - date1) / (1000 * 3600 * 24)))\n        }\n        //\n      }\n    }\n    return montantReglement;\n  }\n  reservationReglement(numReglement){\n    const stock = this.props.reserver.dataReserver.filter(e=>{\n      return e.numReglement === numReglement;\n    });\n\n    return stock;\n  }\n  componentDidMount() {\n    if (this.props.reserver.dataReserver.length === 0) {\n      axios.get(urlHeader+\"Reservation/get\").then(res => res.data).then(state => this.props.fetchReserver(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n    if (this.props.concerner.dataConcerner.length === 0) {\n      axios.get(urlHeader+\"Concerner/get\").then(res => res.data).then(state => this.props.fetchConcerner(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n    if (this.props.chambres.dataChambres.length === 0) {\n      axios.get(urlHeader+\"Chambres/get\").then(res => res.data).then(state => this.props.fetchchambres(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n  }\n  render() {\n    const reste = this.MontantReservationReglement(this.props.data.numReglement) - this.props.data.nontantReglement\n    return (\n      <div style={{margin: 10, display: 'flex', justifyContent: 'space-between'}}>\n        <div>\n        Num: {this.props.data.numReglement}<br/>\n        Montant Recu: {this.props.data.montantReglement}<br/>\n        Montant Rest: {reste}<br/>\n        Etat: {this.props.data.etatReglement}<br/>\n        Annee: {this.props.data.anneeReglement}\n        {\n          this.reservationReglement(this.props.data.numReglement).map(e=>{\n            return <div key={e.numReservation}>\n              Reservation: {e.numReservation}<br/>\n              Client: {e.numClient}\n            </div>;\n          })\n        }\n        </div>\n        <div>\n          {\n            reste!==0?\n            <div style={{marginRight: 20}} >\n              <TextField type='number' onChange={this.OnChangeUpdateArgentRecu.bind(this, reste)} variant=\"outlined\" value={this.state.argentAjouter} /><br/>\n              <Button\n                size='small'\n                variant=\"contained\"\n                style={{marginTop:5, float: 'right'}}\n                onClick={()=>this.UpdateArgentRecu(this.props.data, reste)}>\n                ajouter\n              </Button>\n          </div>:\n            <Link to=\"/Facture\">\n              <Button\n                size = 'small'\n                variant = \"contained\"\n                style = {\n                  {\n                    marginTop: 5,\n                    float: 'right'\n                  }\n                }>\n                facturer </Button>\n            </Link >\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {reserver: state.reserver, chambres: state.chambres, concerner: state.concerner}\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    fetchchambres: (data) => {\n      dispatch({type: \"FETCH_CHAMBRES\", data: data});\n    },\n    fetchReglements: (data) => {\n      dispatch({type: \"FETCH_REGLEMENTS\", data: data});\n    },\n    fetchReserver: (data) => {\n      dispatch({type: \"FETCH_RESERVER\", data: data});\n    },\n    fetchConcerner: (data) => {\n      dispatch({type: \"FETCH_CONCERNER\", data: data});\n    },\n    updateReglements: (data) => {\n      dispatch({type: \"UPDATE_REGLEMENTS\", data: data});\n    }\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnnexGReglements);\n"]},"metadata":{},"sourceType":"module"}